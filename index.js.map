{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// js/pixabay-api.js\r\nimport axios from 'axios';\r\n\r\n// Ваш унікальний ключ доступу до API Pixabay\r\n// Увага: у реальних проектах ключі API не зберігають прямо в коді!\r\nconst API_KEY = '50196951-391601c250e619b024764c208'; // <-- ЗАМІНІТЬ НА ВАШ КЛЮЧ!\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\n\r\n/**\r\n * Виконує HTTP-запит до Pixabay API для пошуку зображень з пагінацією.\r\n * @param {string} query - Пошукове слово.\r\n * @param {number} page - Номер сторінки результатів.\r\n * @returns {Promise<object>} - Проміс, що резолвиться з об'єктом відповіді (властивість data),\r\n * що містить масив hits та totalHits.\r\n * @throws {Error} - Кидає помилку, якщо запит не вдається.\r\n */\r\nexport async function getImagesByQuery(query, page) {\r\n  // Параметри запиту згідно з ТЗ, включаючи пагінацію\r\n  const params = {\r\n    key: API_KEY,\r\n    q: query,\r\n    image_type: 'photo',\r\n    orientation: 'horizontal',\r\n    safesearch: true,\r\n    page: page, // Додаємо параметр сторінки\r\n    per_page: 15, // Встановлюємо кількість елементів на сторінці (15)\r\n  };\r\n\r\n  try {\r\n    // Виконуємо GET запит за допомогою Axios\r\n    const response = await axios.get(BASE_URL, { params });\r\n\r\n    // Axios автоматично обробляє успішні відповіді (статус 2xx)\r\n    // Повертаємо об'єкт data з відповіді, який містить hits та totalHits\r\n    return response.data;\r\n\r\n  } catch (error) {\r\n    // Обробка помилок мережі або помилок відповіді від сервера\r\n    console.error('Помилка під час запиту до Pixabay API:', error);\r\n    // Кидаємо помилку далі, щоб її обробив main.js\r\n    throw error;\r\n  }\r\n}\r\n","// js/render-functions.js\r\nimport SimpleLightbox from \"simplelightbox\";\r\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\r\n\r\n// Знаходимо контейнер для галереї в DOM\r\nconst galleryElement = document.querySelector('.gallery');\r\n\r\n// Знаходимо елемент лоадера в DOM\r\nconst loaderElement = document.querySelector('.loader'); // Переконайтеся, що у вас є елемент з класом 'loader' в HTML\r\n\r\n// Знаходимо кнопку \"Load more\"\r\nconst loadMoreButton = document.querySelector('.load-more-button'); // Переконайтеся, що у вас є кнопка з класом 'load-more-button'\r\n\r\n// Створюємо екземпляр SimpleLightbox\r\n// Ініціалізуємо його на посиланнях всередині галереї\r\nconst lightbox = new SimpleLightbox('.gallery a', {\r\n    captionsData: 'alt', // Використовуємо атрибут alt зображення як підпис\r\n    captionDelay: 250,   // Затримка в мілісекундах перед появою підпису\r\n});\r\n\r\n/**\r\n * Створює HTML-розмітку для однієї картки зображення.\r\n * @param {object} image - Об'єкт зображення з API.\r\n * @returns {string} - Рядок з HTML-розміткою картки.\r\n */\r\nfunction createImageCard({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\r\n  return `\r\n    <li class=\"gallery-item\">\r\n      <a href=\"${largeImageURL}\">\r\n        <img src=\"${webformatURL}\" alt=\"${tags}\" />\r\n      </a>\r\n      <div class=\"info\">\r\n        <p class=\"info-item\"><b>Likes</b> ${likes}</p>\r\n        <p class=\"info-item\"><b>Views</b> ${views}</p>\r\n        <p class=\"info-item\"><b>Comments</b> ${comments}</p>\r\n        <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\r\n      </div>\r\n    </li>\r\n  `;\r\n}\r\n\r\n/**\r\n * Додає HTML-розмітку для нових зображень в кінець контейнера галереї.\r\n * Оновлює SimpleLightbox.\r\n * @param {array} images - Масив об'єктів зображень для додавання.\r\n */\r\nexport function appendGalleryMarkup(images) {\r\n  // Перевіряємо, чи отримано масив зображень і чи він не порожній\r\n  if (!images || images.length === 0) {\r\n    return; // Якщо масив порожній, нічого не додаємо\r\n  }\r\n\r\n  // Створюємо HTML для всіх нових карток за одну операцію\r\n  const galleryHTML = images.map(image => createImageCard(image)).join('');\r\n\r\n  // Додаємо згенеровану розмітку в кінець контейнера галереї\r\n  galleryElement.insertAdjacentHTML('beforeend', galleryHTML);\r\n\r\n  // Оновлюємо SimpleLightbox після додавання нових елементів до DOM\r\n  lightbox.refresh();\r\n}\r\n\r\n\r\n/**\r\n * Очищає вміст контейнера галереї.\r\n */\r\nexport function clearGallery() {\r\n  galleryElement.innerHTML = ''; // Встановлюємо порожній рядок як вміст\r\n}\r\n\r\n/**\r\n * Показує індикатор завантаження (лоадер).\r\n * Потрібно додати відповідні CSS стилі для класу 'visible'.\r\n */\r\nexport function showLoader() {\r\n  if (loaderElement) {\r\n    loaderElement.classList.add('visible'); // Додаємо клас, що робить лоадер видимим\r\n  }\r\n}\r\n\r\n/**\r\n * Приховує індикатор завантаження (лоадер).\r\n * Потрібно прибрати відповідні CSS стилі для класу 'visible'.\r\n */\r\nexport function hideLoader() {\r\n   if (loaderElement) {\r\n    loaderElement.classList.remove('visible'); // Прибираємо клас, що робить лоадер видимим\r\n  }\r\n}\r\n\r\n/**\r\n * Показує кнопку \"Load more\".\r\n * Прибирає клас 'is-hidden'.\r\n */\r\nexport function showLoadMoreButton() {\r\n  if (loadMoreButton) {\r\n    loadMoreButton.classList.remove('is-hidden');\r\n  }\r\n}\r\n\r\n/**\r\n * Приховує кнопку \"Load more\".\r\n * Додає клас 'is-hidden'.\r\n */\r\nexport function hideLoadMoreButton() {\r\n  if (loadMoreButton) {\r\n    loadMoreButton.classList.add('is-hidden');\r\n  }\r\n}\r\n\r\n/**\r\n * Отримує висоту однієї картки галереї для плавного прокручування.\r\n * @returns {number} Висота першої картки галереї або 0, якщо галерея порожня.\r\n */\r\nexport function getGalleryCardHeight() {\r\n  const firstGalleryItem = galleryElement.querySelector('.gallery-item');\r\n  if (firstGalleryItem) {\r\n    const cardRect = firstGalleryItem.getBoundingClientRect();\r\n    return cardRect.height;\r\n  }\r\n  return 0; // Повертаємо 0, якщо елементів немає\r\n}\r\n","// js/main.js\r\nimport { getImagesByQuery } from './js/pixabay-api'; // Імпортуємо функцію запиту до API\r\nimport {\r\n  appendGalleryMarkup, // Змінили імпорт, тепер додаємо розмітку\r\n  clearGallery,\r\n  showLoader,\r\n  hideLoader,\r\n  showLoadMoreButton, // Імпортуємо нові функції для кнопки\r\n  hideLoadMoreButton,\r\n  getGalleryCardHeight // Імпортуємо функцію для отримання висоти картки\r\n} from './js/render-functions'; // Імпортуємо функції рендеру та керування лоадером\r\nimport iziToast from \"izitoast\"; // Імпортуємо бібліотеку повідомлень\r\nimport \"izitoast/dist/css/iziToast.min.css\"; // Імпортуємо стилі iziToast\r\n\r\n\r\n// Знаходимо елементи DOM\r\nconst searchForm = document.querySelector('.form');\r\nconst searchInput = searchForm.querySelector('input[name=\"search-text\"]');\r\nconst loadMoreButton = document.querySelector('.load-more-button'); // Знаходимо кнопку \"Load more\"\r\n\r\n// Змінні стану для пагінації та поточного запиту\r\nlet currentQuery = '';\r\nlet currentPage = 1;\r\nconst perPage = 15; // Кількість елементів на сторінці, як вимагає ТЗ\r\nlet totalHits = 0; // Загальна кількість знайдених зображень\r\n\r\n// Приховуємо кнопку \"Load more\" при першому завантаженні сторінки\r\nhideLoadMoreButton();\r\n\r\n\r\n// Обробник події 'submit' для форми пошуку\r\nsearchForm.addEventListener('submit', async (event) => {\r\n  event.preventDefault(); // Зупиняємо стандартну дію браузера (перезавантаження сторінки)\r\n\r\n  const query = searchInput.value.trim(); // Отримуємо пошуковий запит\r\n\r\n  // Перевіряємо, чи не є запит порожнім рядком\r\n  if (query === '') {\r\n    iziToast.warning({\r\n      title: 'Увага',\r\n      message: 'Будь ласка, введіть пошуковий запит.',\r\n      position: 'topRight',\r\n    });\r\n    return;\r\n  }\r\n\r\n  // Скидаємо стан для нового пошуку\r\n  currentQuery = query;\r\n  currentPage = 1;\r\n  totalHits = 0; // Скидаємо загальну кількість знайдених зображень\r\n  clearGallery(); // Очищаємо галерею\r\n  hideLoadMoreButton(); // Приховуємо кнопку \"Load more\" перед новим пошуком\r\n  showLoader(); // Показуємо індикатор завантаження\r\n\r\n  try {\r\n    // Виконуємо перший запит до Pixabay API\r\n    const data = await getImagesByQuery(currentQuery, currentPage);\r\n\r\n    // Перевіряємо, чи отримано будь-які зображення\r\n    if (data.hits.length === 0) {\r\n      iziToast.info({\r\n        title: 'Інформація',\r\n        message: 'На жаль, зображень за вашим запитом не знайдено. Спробуйте ще раз!',\r\n        position: 'topRight',\r\n      });\r\n    } else {\r\n      // Якщо зображення знайдені, відображаємо їх\r\n      appendGalleryMarkup(data.hits); // Використовуємо appendGalleryMarkup\r\n      totalHits = data.totalHits; // Зберігаємо загальну кількість знайдених зображень\r\n\r\n      // Перевіряємо, чи є ще сторінки для завантаження\r\n      if (data.hits.length < totalHits) {\r\n         showLoadMoreButton(); // Показуємо кнопку \"Load more\"\r\n      } else {\r\n         // Якщо на першій сторінці вже всі результати\r\n         iziToast.info({\r\n           title: 'Інформація',\r\n           message: \"We're sorry, but you've reached the end of search results.\",\r\n           position: 'topRight',\r\n         });\r\n      }\r\n    }\r\n\r\n  } catch (error) {\r\n    // Обробка помилок запиту\r\n     iziToast.error({\r\n        title: 'Помилка',\r\n        message: 'Не вдалося завантажити зображення. Спробуйте пізніше.',\r\n        position: 'topRight',\r\n      });\r\n      console.error('Помилка пошуку:', error);\r\n  } finally {\r\n    // Виконується завжди\r\n    hideLoader(); // Приховуємо індикатор завантаження\r\n    searchForm.reset(); // Очищаємо поле вводу форми\r\n  }\r\n});\r\n\r\n// Обробник події 'click' для кнопки \"Load more\"\r\nloadMoreButton.addEventListener('click', async () => {\r\n  currentPage += 1; // Збільшуємо номер сторінки\r\n  showLoader(); // Показуємо індикатор завантаження\r\n  hideLoadMoreButton(); // Приховуємо кнопку \"Load more\" під час завантаження\r\n\r\n  try {\r\n    // Виконуємо запит за наступною сторінкою\r\n    const data = await getImagesByQuery(currentQuery, currentPage);\r\n\r\n    // Додаємо нові зображення до галереї\r\n    appendGalleryMarkup(data.hits);\r\n\r\n    // Перевіряємо, чи є ще сторінки для завантаження\r\n    const loadedImagesCount = currentPage * perPage;\r\n    if (loadedImagesCount < totalHits) {\r\n       showLoadMoreButton(); // Показуємо кнопку \"Load more\"\r\n    } else {\r\n       // Якщо дійшли до кінця колекції\r\n       hideLoadMoreButton(); // Ховаємо кнопку\r\n       iziToast.info({\r\n         title: 'Інформація',\r\n         message: \"We're sorry, but you've reached the end of search results.\",\r\n         position: 'topRight',\r\n       });\r\n    }\r\n\r\n    // Плавне прокручування сторінки\r\n    const cardHeight = getGalleryCardHeight();\r\n    if (cardHeight > 0) {\r\n       window.scrollBy({\r\n         top: cardHeight * 2, // Прокручуємо на дві висоти картки\r\n         behavior: 'smooth' // Робимо прокручування плавним\r\n       });\r\n    }\r\n\r\n\r\n  } catch (error) {\r\n    // Обробка помилок запиту\r\n     iziToast.error({\r\n        title: 'Помилка',\r\n        message: 'Не вдалося завантажити додаткові зображення. Спробуйте пізніше.',\r\n        position: 'topRight',\r\n      });\r\n      console.error('Помилка завантаження додаткових зображень:', error);\r\n      showLoadMoreButton(); // На випадок помилки, можливо, варто показати кнопку знову\r\n  } finally {\r\n    // Виконується завжди\r\n    hideLoader(); // Приховуємо індикатор завантаження\r\n  }\r\n});\r\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","params","axios","error","galleryElement","loaderElement","loadMoreButton","lightbox","SimpleLightbox","createImageCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","appendGalleryMarkup","images","galleryHTML","image","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getGalleryCardHeight","firstGalleryItem","searchForm","searchInput","currentQuery","currentPage","perPage","totalHits","event","iziToast","data","cardHeight"],"mappings":"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"}